// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum User_Role {
  traveller
  travel_supplier
  hotel_supplier
  restaurant_supplier
  transportation_supplier
  admin
}

enum User_Status {
  active
  inactive
}

model User {
  id_user       Int         @id @default(autoincrement()) @db.UnsignedInt
  username      String      @unique @db.VarChar(100)
  password      String      @db.VarChar(100)
  id_role       User_Role
  name          String      @db.VarChar(100)
  email         String      @unique @db.VarChar(100)
  Gender        Boolean
  date_of_birth DateTime
  phone_number  String      @db.Char(10)
  Address       String      @db.Text
  create_at     DateTime    @default(now())
  Point         Int         @db.UnsignedMediumInt
  status        User_Status

  info_supplier Info_Supplier[]
  product       Product[]
  discount      Discount[]
  cart          Cart[]
  bill          Bill[]
  rate          Rate[]
  contact       Contact[]
  info_contact  Info_Contact[]
}

model Info_Supplier {
  id_info_supplier Int    @id @default(autoincrement()) @db.UnsignedMediumInt
  id_user          Int    @db.UnsignedInt
  user             User   @relation(fields: [id_user], references: [id_user])
  tax_id_number    String @unique @db.VarChar(13)
  Fee              Int    @db.UnsignedSmallInt
}

model City {
  id_city Int    @id @default(autoincrement()) @db.UnsignedMediumInt
  name    String @unique

  location Location[]
}

model Location {
  id_location  Int    @id @default(autoincrement()) @db.UnsignedInt
  system_name  String @unique
  display_name String
  id_city      Int    @db.UnsignedMediumInt
  city         City   @relation(fields: [id_city], references: [id_city])

  product Product[]
}

enum Product_Status {
  active
  inactive
  cancel
}

model Product {
  id_product     Int            @id @default(autoincrement()) @db.UnsignedInt
  name           String
  id_user        Int            @db.UnsignedInt
  user           User           @relation(fields: [id_user], references: [id_user])
  Location_map   String
  start_time     DateTime
  end_time       DateTime
  quantity       Int            @db.UnsignedSmallInt
  price          Int            @db.UnsignedInt
  Age            Int            @db.UnsignedSmallInt
  count_complete BigInt         @db.UnsignedBigInt
  description    String         @db.LongText
  avg_rate       Int            @db.UnsignedInt
  id_location    Int            @db.UnsignedInt
  location       Location       @relation(fields: [id_location], references: [id_location])
  status         Product_Status

  discount  Discount[]
  info_cart Info_Cart[]
  info_bill Info_Bill[]
  rate      Rate[]
}

model Discount {
  id_discount Int      @id @default(autoincrement()) @db.UnsignedInt
  id_user     Int      @db.UnsignedInt
  user        User     @relation(fields: [id_user], references: [id_user])
  id_product  Int      @db.UnsignedInt
  product     Product  @relation(fields: [id_product], references: [id_product])
  start_time  DateTime
  end_time    DateTime
  value       Int      @db.UnsignedSmallInt
  count       Int      @db.UnsignedSmallInt
  Point       Int      @db.UnsignedMediumInt

  bill Bill[]
}

model Cart {
  id_cart Int  @id @default(autoincrement()) @db.UnsignedInt
  id_user Int  @db.UnsignedInt
  user    User @relation(fields: [id_user], references: [id_user])

  info_cart Info_Cart[]
}

model Info_Cart {
  id_info_cart Int     @id @default(autoincrement()) @db.UnsignedInt
  id_cart      Int     @db.UnsignedInt
  cart         Cart    @relation(fields: [id_cart], references: [id_cart])
  id_product   Int     @db.UnsignedInt
  poruduct     Product @relation(fields: [id_product], references: [id_product])
}

enum Bill_Status {
  done
  complete
  paiding
  cancel
}

model Bill {
  id_bill     Int         @id @default(autoincrement()) @db.UnsignedInt
  id_user     Int         @db.UnsignedInt
  user        User        @relation(fields: [id_bill], references: [id_user])
  time        DateTime    @default(now())
  id_discount Int         @db.UnsignedInt
  discount    Discount    @relation(fields: [id_discount], references: [id_discount])
  quantity    Int         @db.UnsignedSmallInt
  status      Bill_Status

  info_bill Info_Bill[]
}

model Info_Bill {
  id_info_bill Int     @id @default(autoincrement()) @db.UnsignedInt
  id_bill      Int     @db.UnsignedInt
  bill         Bill    @relation(fields: [id_bill], references: [id_bill])
  id_product   Int     @db.UnsignedInt
  product      Product @relation(fields: [id_product], references: [id_product])
}

enum Rate_Status {
  presently
  hidden
}

model Rate {
  id_rate    Int         @id @default(autoincrement()) @db.UnsignedInt
  id_product Int         @db.UnsignedInt
  product    Product     @relation(fields: [id_product], references: [id_product])
  id_user    Int         @db.UnsignedInt
  user       User        @relation(fields: [id_user], references: [id_user])
  comment    String      @db.Text
  star       Int         @db.UnsignedSmallInt
  status     Rate_Status
}

model Contact {
  id_contact   Int  @id @default(autoincrement()) @db.UnsignedInt
  id_user_call Int  @db.UnsignedInt
  user_call    User @relation(fields: [id_user_call], references: [id_user], map: "user_call")

  id_info_contact Info_Contact[]
}

model Info_Contact {
  id_info_contact Int      @id @default(autoincrement()) @db.UnsignedInt
  id_contact      Int      @db.UnsignedInt
  contact         Contact  @relation(fields: [id_contact], references: [id_contact])
  id_user_listen  Int      @db.UnsignedInt
  user_listen     User     @relation(fields: [id_user_listen], references: [id_user])
  message         String   @db.Text
  time            DateTime @default(now())
}